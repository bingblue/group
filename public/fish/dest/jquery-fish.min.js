/*! main 2015-04-07 11:03:04 
 * 作者：小牧COOL 
 * QQ：895355044 
 * 版本：0.0.1 
 */!function(a){a.fn.fish=function(b){function c(a){return Math.ceil(Math.random()*(n-a))}function d(){var a=Math.ceil(100*Math.random());return a<C[0]?B[0]:a<C[1]?B[1]:a<C[2]?B[2]:a<C[3]?B[3]:a<C[4]?B[4]:a<C[5]?B[5]:a<C[6]?B[6]:a<C[7]?B[7]:void 0}function e(b,c,d,e,f){if(b+100-10>=D&&D>=b+50+10&&c+80-30>=E&&E>=c+10){clearInterval(f),F+=d.score,e.css({left:"+=30",top:"+=30"});var g=e.clone();g.css({position:"relative",right:"-87%",display:"block",top:"-16px",left:"auto","-webkit-transform":"rotate(-90deg)"}),g.appendTo(".fishrod-box").animate({"-webkit-transform":"rotate(-90deg)"},1e3),e.remove(),a(".add-score").text("+"+d.score).css({top:E-30,left:D+30}).show(),D=0,E=0,setTimeout(function(){k.find(".fishline").animate({height:0},500,function(){g.remove(),a(".add-score").hide()})},100),a(".score b").text(F),i.success()}}function f(){var b,f=d();b=f.height?f.height:80;var g=c(b),h=g,i=a("<img class='fish-item' width='"+f.width+"' height='"+b+"' />").attr({src:f.image}).css({left:-f.width,top:g}).appendTo(j),k=-f.width,l=setInterval(function(){if(m>k){i.css({top:h,left:k});var a=i.offset().top;0!=D&&0!=E&&e(k,a,f,i,l)}else clearInterval(l),i.remove();k+=2},p)}function g(){window.event.returnValue=!1}var h={time:60,man:{id:1,width:75,height:75,image:"images/man.png"},moon:{id:2,width:100,height:80,image:"images/fish01.png",scoreImg:"images/J1.png",score:30},moon2:{id:3,width:100,height:80,image:"images/fish04.png",scoreImg:"images/J1.png",score:40},moon3:{id:4,width:100,height:80,image:"images/fish05.png",scoreImg:"images/J1.png",score:50},moon4:{id:5,width:100,height:80,image:"images/fish06.png",scoreImg:"images/J1.png",score:60},moon5:{id:6,width:100,height:80,image:"images/fish07.png",scoreImg:"images/J1.png",score:70},moon6:{id:7,width:100,height:80,image:"images/fish10.png",scoreImg:"images/J1.png",score:80},moon7:{id:8,width:100,height:80,image:"images/fish11.png",scoreImg:"images/J1.png",score:90},moon8:{id:9,width:100,height:80,image:"images/fish11.png",scoreImg:"images/J1.png",score:100},bomb:{id:5,width:60,height:40,image:"images/bomb.png",score:-1},bomb2:null,over:function(){},success:function(){}},i=a.extend(h,b),j=a(this),k=a(".fishrod-box"),l=k.offset().top+k.height()-k.find(".fishhook").height()/5,m=j.width(),n=j.height(),o=800,p=20,q=(i.man,i.moon),r=i.moon4,s=i.moon5,t=i.moon6,u=i.moon7,v=i.moon8,w=null==i.moon2?i.moon:i.moon2;w.id=3;var x=null==i.moon3?i.moon:i.moon3;x.id=4;var y=(i.bomb,null==i.bomb2?i.bomb:i.bomb2);y.id=6;var z,A=!1,B=[q,w,x,r,s,t,u,v],C=[30,40,50,60,70,80,90,100],D=0,E=0,F=0,G=null,H=i.time,I=null;z=setInterval(f,o),I=setInterval(function(){--H,a(".time b").text(10>H?"00:0"+H:"00:"+H),0>=H&&(H=0,clearInterval(z),clearInterval(I),a(".fish-item").remove(),D=0,E=0,i.over(F))},1e3);var J={l:D,t:E,sx:0,sy:0,ex:0,ey:0},K=a(".fish-box")[0];K.addEventListener("touchstart",function(b){if(null!=G||1==A)return!1;A=!0,E=0,D=0,J.sx=b.targetTouches[0].pageX,J.sy=b.targetTouches[0].pageY,J.ex=J.sx,J.ey=J.sy,a(".sight").css({top:J.sy-a(".sight").height()/2,left:J.sx-a(".sight").width()/2}).fadeIn(200,function(){a(this).fadeOut(1500)});var c=J.sx-m,d=J.sy-l;k.animate({left:c},500,function(){var a=0;G=setInterval(function(){d>a?a+=2:(a=d,clearInterval(G),G=null,E=a+l,D=J.sx,setTimeout(function(){D=0,E=0,k.find(".fishline").animate({height:0},200,function(){A=!1})},500)),k.find(".fishline").css({height:a})},2)}),b.stopPropagation(),b.preventDefault()},!1),document.body.addEventListener("touchmove",function(){}),document.oncontextmenu=g}}(jQuery);