/*! main 2015-04-01 17:21:57 
 * 作者：小牧COOL 
 * QQ：895355044 
 * 版本：0.0.1 
 */!function(a){a.fn.fish=function(b){function c(a){return Math.ceil(Math.random()*(n-a))}function d(){var a=Math.ceil(100*Math.random());return a<B[0]?A[0]:a<B[1]?A[1]:a<B[2]?A[2]:a<B[3]?A[3]:a<B[4]?A[4]:a<B[5]?A[5]:a<B[6]?A[6]:a<B[7]?A[7]:void 0}function e(b,c,d,e,f){if(b+100-10>=C&&C>=b+50+10&&c+80-30>=D&&D>=c+10){clearInterval(f),E+=d.score,e.css({left:"+=30",top:"+=30"});var g=e.clone();g.css({position:"relative",right:"-87%",display:"block",top:"-16px",left:"auto","-webkit-transform":"rotate(-90deg)"}),g.appendTo(".fishrod-box").animate({"-webkit-transform":"rotate(-90deg)"},1e3),e.remove(),a(".add-score").text("+"+d.score).css({top:D-30,left:C+30}).show(),C=0,D=0,setTimeout(function(){k.find(".fishline").animate({height:0},500,function(){g.remove(),a(".add-score").hide()})},100),a(".score b").text(E)}}function f(){var b=d(),f=c(b.height),g=f,h=a("<img class='fish-item' width='"+b.width+"' height='"+b.height+"' />").attr({src:b.image}).css({left:-b.width,top:f}).appendTo(j),i=-b.width,k=setInterval(function(){if(m>i){h.css({top:g,left:i});var a=h.offset().top;0!=C&&0!=D&&e(i,a,b,h,k)}else clearInterval(k),h.remove();i+=2},p)}function g(){window.event.returnValue=!1}var h={man:{id:1,width:75,height:75,image:"images/man.png"},moon:{id:2,width:100,height:80,image:"images/fish01.png",scoreImg:"images/J1.png",score:30},moon2:{id:3,width:100,height:80,image:"images/fish04.png",scoreImg:"images/J1.png",score:40},moon3:{id:4,width:100,height:80,image:"images/fish05.png",scoreImg:"images/J1.png",score:50},moon4:{id:5,width:100,height:80,image:"images/fish06.png",scoreImg:"images/J1.png",score:60},moon5:{id:6,width:100,height:80,image:"images/fish07.png",scoreImg:"images/J1.png",score:70},moon6:{id:7,width:100,height:80,image:"images/fish10.png",scoreImg:"images/J1.png",score:80},moon7:{id:8,width:100,height:80,image:"images/fish11.png",scoreImg:"images/J1.png",score:90},moon8:{id:9,width:100,height:80,image:"images/fish11.png",scoreImg:"images/J1.png",score:100},bomb:{id:5,width:60,height:40,image:"images/bomb.png",score:-1},bomb2:null,over:function(){}},i=a.extend(h,b),j=a(this),k=a(".fishrod-box"),l=k.offset().top+k.height()-k.find(".fishhook").height()/5,m=j.width(),n=j.height(),o=800,p=20,q=(i.man,i.moon),r=i.moon4,s=i.moon5,t=i.moon6,u=i.moon7,v=i.moon8,w=null==i.moon2?i.moon:i.moon2;w.id=3;var x=null==i.moon3?i.moon:i.moon3;x.id=4;var y=(i.bomb,null==i.bomb2?i.bomb:i.bomb2);y.id=6;var z,A=[q,w,x,r,s,t,u,v],B=[30,40,50,60,70,80,90,100],C=0,D=0,E=0,F=null,G=30,H=null;z=setInterval(f,o),H=setInterval(function(){--G,a(".time b").text(10>G?"00:0"+G:"00:"+G),0>=G&&(G=0,clearInterval(z),clearInterval(H),a(".fish-item").remove(),C=0,D=0,i.over(E))},1e3);var I={l:C,t:D,sx:0,sy:0,ex:0,ey:0},J=a(".fish-box")[0];J.addEventListener("touchstart",function(b){if(D=0,C=0,I.sx=event.targetTouches[0].pageX,I.sy=event.targetTouches[0].pageY,I.ex=I.sx,I.ey=I.sy,null!=F)return!1;a(".sight").css({top:I.sy-a(".sight").height()/2,left:I.sx-a(".sight").width()/2}).fadeIn(200,function(){a(this).fadeOut(1500)}),k.find(".fishline").animate({height:0},200);var c=I.sx-m,d=I.sy-l;k.animate({left:c},500,function(){var a=0;F=setInterval(function(){d>a?a+=2:(a=d,clearInterval(F),F=null,D=a+l,C=I.sx,setTimeout(function(){C=0,D=0,k.find(".fishline").animate({height:0},200)},500)),k.find(".fishline").css({height:a})},2)}),b.stopPropagation(),b.preventDefault()},!1),document.body.addEventListener("touchmove",function(a){a.stopPropagation(),a.preventDefault()}),document.oncontextmenu=g}}(jQuery);